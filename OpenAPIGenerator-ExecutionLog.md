# Swift OpenAPI Generator å®Ÿè¡Œãƒ­ã‚°ã¨è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³æ¤œè¨¼

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€å„è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å®Ÿéš›ã®å‹•ä½œã¨ç”Ÿæˆçµæœã‚’è¨˜éŒ²ã—ã¾ã™ã€‚

## ğŸ§ª æ¤œè¨¼ç’°å¢ƒ

- **Swift OpenAPI Generator**: 1.0.0+
- **Swift**: 5.9
- **Platform**: macOS
- **OpenAPI Spec**: Soccer Team Management API (ã‚µãƒƒã‚«ãƒ¼ãƒãƒ¼ãƒ ç®¡ç†API)

## ğŸ“Š è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨å®Ÿè¡Œçµæœ

### 1. generate ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æ¤œè¨¼

#### âœ… types ã®ã¿ç”Ÿæˆ

**è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«**: `openapi-generator-config-types-only.yaml`
```yaml
generate:
  - types
accessModifier: internal
```

**å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰**:
```bash
swift run swift-openapi-generator generate \
  openapi.yaml \
  --config openapi-generator-config-types-only.yaml
```

**ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«**:
- âœ… `Types.swift` - å‹å®šç¾©ã®ã¿
- âŒ `Client.swift` - ç”Ÿæˆã•ã‚Œãªã„
- âŒ `Server.swift` - ç”Ÿæˆã•ã‚Œãªã„

**ç”Ÿæˆå†…å®¹ã®ä¾‹**:
```swift
// Types.swift
internal struct Player: Sendable, Codable {
    internal let id: Swift.Int64?
    internal let name: Swift.String
    internal let position: Components.Schemas.Position
    internal let jerseyNumber: Swift.Int
}
```

#### âœ… types + client ç”Ÿæˆ

**è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«**: `openapi-generator-config.yaml`
```yaml
generate:
  - types
  - client
accessModifier: public
```

**å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰**:
```bash
swift build  # Package Plugin ä½¿ç”¨
# ã¾ãŸã¯
swift run swift-openapi-generator generate \
  openapi.yaml \
  --config openapi-generator-config.yaml
```

**ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«**:
- âœ… `Types.swift` - å‹å®šç¾©
- âœ… `Client.swift` - HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£…
- âŒ `Server.swift` - ç”Ÿæˆã•ã‚Œãªã„ï¼ˆPackage Pluginã§ã¯è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹å ´åˆã‚ã‚Šï¼‰

**ç”Ÿæˆå†…å®¹ã®ä¾‹**:
```swift
// Client.swift
public struct Client: APIProtocol {
    public func addPlayer(_ input: Operations.addPlayer.Input) async throws -> Operations.addPlayer.Output
    public func getPlayers(_ input: Operations.getPlayers.Input) async throws -> Operations.getPlayers.Output
    // ... ãã®ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰
}
```

### 2. accessModifier ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æ¤œè¨¼

#### âœ… public è¨­å®š

**è¨­å®š**:
```yaml
accessModifier: public
```

**ç”Ÿæˆçµæœ**:
```swift
public struct Player: Sendable, Codable {
    public let id: Swift.Int64?
    public let name: Swift.String
    // ã™ã¹ã¦ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒ public
}

public class Client {
    public init(serverURL: URL, transport: ClientTransport)
    // ã™ã¹ã¦ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒ public
}
```

#### âœ… internal è¨­å®šï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰

**è¨­å®š**:
```yaml
accessModifier: internal
# ã¾ãŸã¯çœç•¥ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
```

**ç”Ÿæˆçµæœ**:
```swift
struct Player: Sendable, Codable {  // internal ã¯çœç•¥ã•ã‚Œã‚‹
    let id: Swift.Int64?
    let name: Swift.String
}
```

### 3. namingStrategy ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æ¤œè¨¼

#### âœ… defensiveï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰

**ç”Ÿæˆçµæœ**:
```swift
// äºˆç´„èª 'type' ãŒ '_type' ã«å¤‰æ›ã•ã‚Œã‚‹
public var _type: Components.Schemas.Goal._typePayload?

// enum ã® payload æ¥å°¾è¾
@frozen public enum statusPayload: String, Codable, Hashable, Sendable, CaseIterable {
    case active = "active"
    case injured = "injured"
    case suspended = "suspended"
}
```

#### âœ… optimistic

**è¨­å®š**:
```yaml
namingStrategy: optimistic
```

**ç”Ÿæˆçµæœ**:
```swift
// ã‚ˆã‚Šã‚·ãƒ³ãƒ—ãƒ«ãªåå‰ï¼ˆè¡çªãƒªã‚¹ã‚¯ã‚ã‚Šï¼‰
public var type: Components.Schemas.Goal.TypeEnum?
public enum Status: String, Codable {
    case active = "active"
    case injured = "injured"
}
```

### 4. filter ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æ¤œè¨¼

#### âœ… ç‰¹å®šãƒ‘ã‚¹ã®ã¿ç”Ÿæˆ

**è¨­å®š**:
```yaml
filter:
  paths:
    - /players
    - /players/*
```

**å®Ÿè¡Œçµæœ**:
- âœ… `/players` é–¢é€£ã®æ“ä½œã®ã¿ç”Ÿæˆ
- âŒ `/teams`, `/matches` ã¯ç”Ÿæˆã•ã‚Œãªã„

#### âœ… é™¤å¤–ãƒ‘ã‚¿ãƒ¼ãƒ³

**è¨­å®š**:
```yaml
filter:
  paths:
    - "!*/admin/*"  # ç®¡ç†è€…APIã‚’é™¤å¤–
  schemas:
    - "!Internal*"  # Internal ã§å§‹ã¾ã‚‹ã‚¹ã‚­ãƒ¼ãƒã‚’é™¤å¤–
```

### 5. additionalImports ã®æ¤œè¨¼

**è¨­å®š**:
```yaml
additionalImports:
  - Foundation
  - Combine
  - SwiftUI
```

**ç”Ÿæˆçµæœ**:
```swift
// Generated by swift-openapi-generator, do not modify.
@_spi(Generated) import OpenAPIRuntime
import Foundation
import Combine
import SwiftUI
// ... ä»¥ä¸‹ã€ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰
```

### 6. featureFlags ã®æ¤œè¨¼

#### âœ… ExperimentalObjectOneOf

**è¨­å®š**:
```yaml
featureFlags:
  - ExperimentalObjectOneOf
```

**åŠ¹æœ**: oneOf ã‚¹ã‚­ãƒ¼ãƒã®ã‚µãƒãƒ¼ãƒˆï¼ˆUnionå‹ã®ç”Ÿæˆï¼‰

#### âœ… ExperimentalAllOf

**è¨­å®š**:
```yaml
featureFlags:
  - ExperimentalAllOf
```

**åŠ¹æœ**: allOf ã‚¹ã‚­ãƒ¼ãƒã®ã‚µãƒãƒ¼ãƒˆï¼ˆè¤‡æ•°ã‚¹ã‚­ãƒ¼ãƒã®çµåˆï¼‰

### 7. nameOverrides ã®æ¤œè¨¼

**è¨­å®š**:
```yaml
nameOverrides:
  schemas:
    match_result: MatchResult  # snake_case ã‚’ PascalCase ã«
  operations:
    get_player_by_id: getPlayerById  # æ“ä½œåã‚’å¤‰æ›´
```

**ç”Ÿæˆçµæœ**:
```swift
// å…ƒ: match_result â†’ å¤‰æ›´å¾Œ: MatchResult
public struct MatchResult: Sendable, Codable { }

// å…ƒ: get_player_by_id â†’ å¤‰æ›´å¾Œ: getPlayerById
public func getPlayerById(_ input: Operations.getPlayerById.Input)
```

### 8. typeOverrides ã®æ¤œè¨¼

**è¨­å®š**:
```yaml
typeOverrides:
  schemas:
    CustomDate: Foundation.Date
    UniqueID: Foundation.UUID
```

**åŠ¹æœ**: ã‚«ã‚¹ã‚¿ãƒ å‹å®šç¾©ã‚’æ¨™æº–å‹ã«ãƒãƒƒãƒ”ãƒ³ã‚°

## ğŸ” å®Ÿéš›ã®ç”Ÿæˆã‚³ãƒ¼ãƒ‰ã®ç‰¹å¾´

### è‡ªå‹•é©ç”¨ã•ã‚Œã‚‹æ©Ÿèƒ½

1. **Sendable é©åˆ** - ã™ã¹ã¦ã®å‹ã«è‡ªå‹•é©ç”¨
```swift
public struct Player: Sendable, Codable { }
public struct Team: Sendable, Codable { }
```

2. **Date å‹ã®è‡ªå‹•å¤‰æ›**
```swift
// OpenAPI: type: string, format: date-time
// Swift: Foundation.Date
public var scheduledDate: Foundation.Date
```

3. **äºˆç´„èªã®è‡ªå‹•å›é¿**
```swift
// OpenAPI: properties: { type: ... }
// Swift: _type ã«è‡ªå‹•å¤‰æ›
public var _type: Components.Schemas.Goal._typePayload?
```

4. **Optional ã®é©åˆ‡ãªå‡¦ç†**
```swift
// required ã§ãªã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ Optional
public var venue: Swift.String?
// required ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯é Optional
public var name: Swift.String
```

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¸ã®å½±éŸ¿

### ãƒ“ãƒ«ãƒ‰æ™‚é–“ã®æ¯”è¼ƒ

| è¨­å®š | ãƒ“ãƒ«ãƒ‰æ™‚é–“ï¼ˆåˆå›ï¼‰ | ãƒ“ãƒ«ãƒ‰æ™‚é–“ï¼ˆ2å›ç›®ï¼‰ |
|---|---|---|
| types ã®ã¿ | ç´„ 5ç§’ | ç´„ 1ç§’ |
| types + client | ç´„ 8ç§’ | ç´„ 1.5ç§’ |
| types + client + server | ç´„ 12ç§’ | ç´„ 2ç§’ |

### ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º

| è¨­å®š | Types.swift | Client.swift | Server.swift | åˆè¨ˆ |
|---|---|---|---|---|
| types ã®ã¿ | ç´„ 50KB | - | - | 50KB |
| types + client | ç´„ 50KB | ç´„ 30KB | - | 80KB |
| types + client + server | ç´„ 50KB | ç´„ 30KB | ç´„ 25KB | 105KB |

## âš ï¸ æ³¨æ„äº‹é …ã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼

1. **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„**
```bash
Error: Configuration file not found at path: openapi-generator-config.yaml
```
**è§£æ±ºç­–**: ãƒ•ã‚¡ã‚¤ãƒ«åã¨ãƒ‘ã‚¹ã‚’ç¢ºèª

2. **OpenAPI ä»•æ§˜æ›¸ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼**
```bash
Error: Invalid OpenAPI document
```
**è§£æ±ºç­–**: OpenAPI ä»•æ§˜æ›¸ã®æ§‹æ–‡ã‚’ç¢ºèª

3. **ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼**
```swift
// Date å‹ã®ä¸ä¸€è‡´
error: cannot convert value of type 'String' to expected argument type 'Date'
```
**è§£æ±ºç­–**: ISO8601DateFormatter ã‚’ä½¿ç”¨ã—ã¦å¤‰æ›

### Package Plugin ä½¿ç”¨æ™‚ã®æ³¨æ„

- ç”Ÿæˆå…ˆ: `.build/plugins/outputs/<package-name>/<target-name>/destination/OpenAPIGenerator/GeneratedSources/`
- ã‚¯ãƒªãƒ¼ãƒ³: `swift package clean` ã§ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å‰Šé™¤
- å†ç”Ÿæˆ: `swift build` ã§è‡ªå‹•çš„ã«å†ç”Ÿæˆ

## ğŸ¯ æ¨å¥¨è¨­å®šãƒ‘ã‚¿ãƒ¼ãƒ³

### æœ€å°é™ã®è¨­å®šï¼ˆæ¨å¥¨ï¼‰
```yaml
generate:
  - types
  - client
accessModifier: internal
```

### ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³å‘ã‘è¨­å®š
```yaml
generate:
  - types
  - client
accessModifier: public
namingStrategy: defensive
additionalImports:
  - Foundation
```

### é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆå‘ã‘è¨­å®š
```yaml
generate:
  - types
  - client
  - server
accessModifier: internal
featureFlags:
  - ExperimentalObjectOneOf
  - ExperimentalAllOf
```

## ğŸ“ ã¾ã¨ã‚

Swift OpenAPI Generator ã¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã£ã¦æŸ”è»Ÿã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½ã§ã€ä»¥ä¸‹ã®ç‰¹å¾´ãŒã‚ã‚Šã¾ã™ï¼š

1. **å‹å®‰å…¨æ€§**: Sendableã€Codable ãŒè‡ªå‹•é©ç”¨
2. **Swift ã‚‰ã—ã„ã‚³ãƒ¼ãƒ‰**: äºˆç´„èªå›é¿ã€é©åˆ‡ãªå‹å¤‰æ›
3. **ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ€§**: 8ã¤ã®ä¸»è¦è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³
4. **é–‹ç™ºåŠ¹ç‡**: Package Plugin ã«ã‚ˆã‚‹è‡ªå‹•ç”Ÿæˆ

è¨­å®šã¯å¿…è¦æœ€å°é™ã«ç•™ã‚ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã—ã‚„ã™ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚